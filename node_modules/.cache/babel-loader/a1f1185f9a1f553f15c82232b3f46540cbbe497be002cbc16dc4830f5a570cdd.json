{"ast":null,"code":"var _jsxFileName = \"A:\\\\Development\\\\KavyaFrontedAffordMedical\\\\stock-price-aggregator\\\\src\\\\pages\\\\CorrelationHeatmap.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { getStocks, getStockPriceHistory } from '../services/api';\nimport { getCachedData, setCachedData } from '../utils/cache';\nimport { pearsonCorrelation } from '../utils/math';\nimport { TextField, Button } from '@mui/material';\nimport { debounce } from 'lodash';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CorrelationHeatmap = () => {\n  _s();\n  const [stocks, setStocks] = useState([]);\n  const [minutes, setMinutes] = useState(10);\n  const [correlationMatrix, setCorrelationMatrix] = useState([]);\n  const [stockData, setStockData] = useState({});\n  useEffect(() => {\n    const fetchStocks = async () => {\n      const cachedStocks = getCachedData('stocks');\n      if (cachedStocks) {\n        setStocks(cachedStocks);\n      } else {\n        const data = await getStocks();\n        setStocks(data);\n        setCachedData('stocks', data);\n      }\n    };\n    fetchStocks();\n  }, []);\n  const fetchAllStockData = debounce(async () => {\n    const stockTickers = Object.values(stocks);\n    const stockPrices = {};\n    for (const ticker of stockTickers) {\n      const cacheKey = `${ticker}-${minutes}`;\n      let data = getCachedData(cacheKey);\n      if (!data) {\n        data = await getStockPriceHistory(ticker, minutes);\n        setCachedData(cacheKey, data);\n      }\n      stockPrices[ticker] = data.map(entry => parseFloat(entry.price));\n    }\n    setStockData(stockPrices);\n    calculateCorrelationMatrix(stockPrices, stockTickers);\n  }, 500);\n  const calculateCorrelationMatrix = (stockPrices, tickers) => {\n    const matrix = tickers.map(tickerX => tickers.map(tickerY => {\n      if (tickerX === tickerY) return 1;\n      const pricesX = stockPrices[tickerX];\n      const pricesY = stockPrices[tickerY];\n      if (!pricesX || !pricesY || pricesX.length !== pricesY.length) return 0;\n      return pearsonCorrelation(pricesX, pricesY);\n    }));\n    setCorrelationMatrix(matrix);\n  };\n  const getColor = value => {\n    if (value === 1) return '#ffffff';\n    const r = Math.floor(255 * (1 - value));\n    const g = Math.floor(255 * value);\n    return `rgb(${r}, ${g}, 0)`;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '20px'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Correlation Heatmap\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TextField, {\n      label: \"Minutes\",\n      type: \"number\",\n      value: minutes,\n      onChange: e => setMinutes(e.target.value),\n      style: {\n        margin: '10px'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      onClick: fetchAllStockData,\n      style: {\n        margin: '10px'\n      },\n      children: \"Generate Heatmap\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), correlationMatrix.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        overflowX: 'auto'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        style: {\n          borderCollapse: 'collapse',\n          margin: '20px 0'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 17\n            }, this), Object.values(stocks).map(ticker => /*#__PURE__*/_jsxDEV(\"th\", {\n              style: {\n                padding: '10px',\n                border: '1px solid #ccc'\n              },\n              children: ticker\n            }, ticker, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 19\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: correlationMatrix.map((row, rowIndex) => /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              style: {\n                padding: '10px',\n                border: '1px solid #ccc'\n              },\n              children: Object.values(stocks)[rowIndex]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 19\n            }, this), row.map((value, colIndex) => /*#__PURE__*/_jsxDEV(\"td\", {\n              style: {\n                padding: '10px',\n                border: '1px solid #ccc',\n                backgroundColor: getColor(value),\n                color: value === 1 ? '#000' : '#fff',\n                textAlign: 'center'\n              },\n              children: value.toFixed(2)\n            }, colIndex, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 21\n            }, this))]\n          }, rowIndex, true, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n_s(CorrelationHeatmap, \"wVwzznfYRYmP/V46H/IV62h/FUE=\");\n_c = CorrelationHeatmap;\nexport default CorrelationHeatmap;\nvar _c;\n$RefreshReg$(_c, \"CorrelationHeatmap\");","map":{"version":3,"names":["React","useState","useEffect","getStocks","getStockPriceHistory","getCachedData","setCachedData","pearsonCorrelation","TextField","Button","debounce","jsxDEV","_jsxDEV","CorrelationHeatmap","_s","stocks","setStocks","minutes","setMinutes","correlationMatrix","setCorrelationMatrix","stockData","setStockData","fetchStocks","cachedStocks","data","fetchAllStockData","stockTickers","Object","values","stockPrices","ticker","cacheKey","map","entry","parseFloat","price","calculateCorrelationMatrix","tickers","matrix","tickerX","tickerY","pricesX","pricesY","length","getColor","value","r","Math","floor","g","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","label","type","onChange","e","target","margin","variant","onClick","overflowX","borderCollapse","border","row","rowIndex","colIndex","backgroundColor","color","textAlign","toFixed","_c","$RefreshReg$"],"sources":["A:/Development/KavyaFrontedAffordMedical/stock-price-aggregator/src/pages/CorrelationHeatmap.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { getStocks, getStockPriceHistory } from '../services/api';\r\nimport { getCachedData, setCachedData } from '../utils/cache';\r\nimport { pearsonCorrelation } from '../utils/math';\r\nimport { TextField, Button } from '@mui/material';\r\nimport { debounce } from 'lodash';\r\n\r\nconst CorrelationHeatmap = () => {\r\n  const [stocks, setStocks] = useState([]);\r\n  const [minutes, setMinutes] = useState(10);\r\n  const [correlationMatrix, setCorrelationMatrix] = useState([]);\r\n  const [stockData, setStockData] = useState({});\r\n\r\n  useEffect(() => {\r\n    const fetchStocks = async () => {\r\n      const cachedStocks = getCachedData('stocks');\r\n      if (cachedStocks) {\r\n        setStocks(cachedStocks);\r\n      } else {\r\n        const data = await getStocks();\r\n        setStocks(data);\r\n        setCachedData('stocks', data);\r\n      }\r\n    };\r\n    fetchStocks();\r\n  }, []);\r\n\r\n  const fetchAllStockData = debounce(async () => {\r\n    const stockTickers = Object.values(stocks);\r\n    const stockPrices = {};\r\n    for (const ticker of stockTickers) {\r\n      const cacheKey = `${ticker}-${minutes}`;\r\n      let data = getCachedData(cacheKey);\r\n      if (!data) {\r\n        data = await getStockPriceHistory(ticker, minutes);\r\n        setCachedData(cacheKey, data);\r\n      }\r\n      stockPrices[ticker] = data.map((entry) => parseFloat(entry.price));\r\n    }\r\n    setStockData(stockPrices);\r\n    calculateCorrelationMatrix(stockPrices, stockTickers);\r\n  }, 500);\r\n\r\n  const calculateCorrelationMatrix = (stockPrices, tickers) => {\r\n    const matrix = tickers.map((tickerX) =>\r\n      tickers.map((tickerY) => {\r\n        if (tickerX === tickerY) return 1;\r\n        const pricesX = stockPrices[tickerX];\r\n        const pricesY = stockPrices[tickerY];\r\n        if (!pricesX || !pricesY || pricesX.length !== pricesY.length) return 0;\r\n        return pearsonCorrelation(pricesX, pricesY);\r\n      })\r\n    );\r\n    setCorrelationMatrix(matrix);\r\n  };\r\n\r\n  const getColor = (value) => {\r\n    if (value === 1) return '#ffffff';\r\n    const r = Math.floor(255 * (1 - value));\r\n    const g = Math.floor(255 * value);\r\n    return `rgb(${r}, ${g}, 0)`;\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '20px' }}>\r\n      <h2>Correlation Heatmap</h2>\r\n      <TextField\r\n        label=\"Minutes\"\r\n        type=\"number\"\r\n        value={minutes}\r\n        onChange={(e) => setMinutes(e.target.value)}\r\n        style={{ margin: '10px' }}\r\n      />\r\n      <Button variant=\"contained\" onClick={fetchAllStockData} style={{ margin: '10px' }}>\r\n        Generate Heatmap\r\n      </Button>\r\n      {correlationMatrix.length > 0 && (\r\n        <div style={{ overflowX: 'auto' }}>\r\n          <table style={{ borderCollapse: 'collapse', margin: '20px 0' }}>\r\n            <thead>\r\n              <tr>\r\n                <th></th>\r\n                {Object.values(stocks).map((ticker) => (\r\n                  <th key={ticker} style={{ padding: '10px', border: '1px solid #ccc' }}>\r\n                    {ticker}\r\n                  </th>\r\n                ))}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {correlationMatrix.map((row, rowIndex) => (\r\n                <tr key={rowIndex}>\r\n                  <td style={{ padding: '10px', border: '1px solid #ccc' }}>\r\n                    {Object.values(stocks)[rowIndex]}\r\n                  </td>\r\n                  {row.map((value, colIndex) => (\r\n                    <td\r\n                      key={colIndex}\r\n                      style={{\r\n                        padding: '10px',\r\n                        border: '1px solid #ccc',\r\n                        backgroundColor: getColor(value),\r\n                        color: value === 1 ? '#000' : '#fff',\r\n                        textAlign: 'center',\r\n                      }}\r\n                    >\r\n                      {value.toFixed(2)}\r\n                    </td>\r\n                  ))}\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CorrelationHeatmap;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}